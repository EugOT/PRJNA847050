<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Evgenii O. Tretiakov">

<title>Dynamics of the hypothalamic arcuate nucleus response to hfd and signalling between astrocytic groups and Agrp or POMC neurons</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/quarto.js"></script>
<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/popper.min.js"></script>
<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-velocity-signalling_hfd-cellchatdb_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02-velocity-signalling_hfd-cellchatdb_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-velocity-signalling_hfd-cellchatdb_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-velocity-signalling_hfd-cellchatdb_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#genes" id="toc-genes" class="nav-link active" data-scroll-target="#genes">genes</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">parameters</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#signalling-analysis" id="toc-signalling-analysis" class="nav-link" data-scroll-target="#signalling-analysis">Signalling analysis</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dynamics of the hypothalamic arcuate nucleus response to hfd and signalling between astrocytic groups and Agrp or POMC neurons</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Evgenii O. Tretiakov </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> watermark <span class="im">import</span> watermark</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils <span class="im">import</span> check_random_state</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gprofiler <span class="im">import</span> GProfiler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pacmap</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> umap</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scvelo <span class="im">as</span> scv</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scanpy <span class="im">as</span> sc</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cellrank <span class="im">as</span> cr</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> anndata <span class="im">as</span> ad</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> liana <span class="im">as</span> li</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> liana.mt <span class="im">import</span> rank_aggregate</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">DeprecationWarning</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="genes" class="level3">
<h3 class="anchored" data-anchor-id="genes">genes</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>npr <span class="op">=</span> [</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1r1"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avpr1a"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcr"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Calcrl"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckar"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cckbr"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntfr"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr1"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crhr2"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Esr1"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr1"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr2"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Galr3"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghr"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrhr"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghsr"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glp1r"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr55"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr83"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpr149"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grpr"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr1"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrtr2"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Igf1r"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insr"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Insrr"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1r"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lepr"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc1r"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc3r"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mc4r"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mchr1"</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmbr"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur1"</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmur2"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr1"</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npffr2"</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr1"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr2"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npr3"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr1"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npsr2"</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy1r"</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy2r"</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy5r"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntrk2"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr1"</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntsr2"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprd1"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprk1"</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprl1"</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oprm1"</span>,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxtr"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlhr"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prlr"</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prokr2"</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfpr"</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp1"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rxfp2"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr1"</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr2"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sstr3"</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr1"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tacr3"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trhr2"</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tshr"</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr1"</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vipr2"</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>npep <span class="op">=</span> [</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adcyap1"</span>,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agrp"</span>,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Avp"</span>,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bdnf"</span>,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cartpt"</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cck"</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cntf"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Crh"</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gal"</span>,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrh"</span>,</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ghrl"</span>,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grp"</span>,</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hcrt"</span>,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Kiss1"</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lep"</span>,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmb"</span>,</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nms"</span>,</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nmu"</span>,</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npvf"</span>,</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npw"</span>,</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Npy"</span>,</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nts"</span>,</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oxt"</span>,</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdyn"</span>,</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Penk"</span>,</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pmch"</span>,</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pnoc"</span>,</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pomc"</span>,</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Qrfp"</span>,</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reln"</span>,</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln1"</span>,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rln3"</span>,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sst"</span>,</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac1"</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tac2"</span>,</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trh"</span>,</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>genes_embed <span class="op">=</span> [</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd1"</span>,</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd2"</span>,</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abcd3"</span>,</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa1"</span>,</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa2"</span>,</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acox1"</span>,</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agrn"</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agt"</span>,</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Alcam"</span>,</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1a1"</span>,</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1l1"</span>,</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldoc"</span>,</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Angpt1"</span>,</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Apoe"</span>,</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">"App"</span>,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aqp4"</span>,</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Arf1"</span>,</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bmp7"</span>,</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bsg"</span>,</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Caf4"</span>,</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ccl25"</span>,</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ckb"</span>,</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr1"</span>,</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cnr2"</span>,</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Col4a5"</span>,</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cst3"</span>,</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dagla"</span>,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daglb"</span>,</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Decr2"</span>,</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dnm1"</span>,</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drp1"</span>,</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ech1"</span>,</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Efna5"</span>,</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Egfr"</span>,</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Enho"</span>,</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Eno1"</span>,</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Faah"</span>,</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fgf1"</span>,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fgfr3"</span>,</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fis1"</span>,</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fos"</span>,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fth1"</span>,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ftl1"</span>,</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gfap"</span>,</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gja1"</span>,</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gli1"</span>,</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glul"</span>,</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai2"</span>,</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnas"</span>,</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">"H2-K1"</span>,</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hacd2"</span>,</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hadhb"</span>,</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hbegf"</span>,</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hepacam"</span>,</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hif1"</span>,</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htra1"</span>,</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Igsf1"</span>,</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Il18"</span>,</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Il1rapl1"</span>,</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Itgav"</span>,</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Jam2"</span>,</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lama2"</span>,</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lamb2"</span>,</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lcat"</span>,</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lgi1"</span>,</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lgi4"</span>,</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lpcat3"</span>,</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lrpap1"</span>,</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lrrc4b"</span>,</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lxn"</span>,</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mdk"</span>,</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mdv1"</span>,</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn1"</span>,</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn2"</span>,</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mgll"</span>,</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mief1"</span>,</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Napepld"</span>,</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ncam1"</span>,</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ncan"</span>,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ndrg2"</span>,</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nfasc"</span>,</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nfia"</span>,</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nlgn3"</span>,</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nrxn1"</span>,</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nrxn2"</span>,</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntn1"</span>,</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ntrk3"</span>,</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Opa1"</span>,</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Otp"</span>,</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex1"</span>,</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex10"</span>,</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex12"</span>,</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex13"</span>,</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex14"</span>,</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex16"</span>,</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex2"</span>,</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex26"</span>,</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex3"</span>,</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pex6"</span>,</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pkm"</span>,</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pla2g7"</span>,</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plcb1"</span>,</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Psap"</span>,</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ptn"</span>,</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pygb"</span>,</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rgma"</span>,</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rtn4"</span>,</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100a1"</span>,</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100a6"</span>,</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">"S100b"</span>,</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scd2"</span>,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sdc2"</span>,</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sema6a"</span>,</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sema6d"</span>,</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sgcd"</span>,</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sirpa"</span>,</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a2"</span>,</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc1a3"</span>,</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc38a1"</span>,</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc4a4"</span>,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc6a11"</span>,</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc7a10"</span>,</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit1"</span>,</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slit2"</span>,</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slitrk2"</span>,</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sorbs1"</span>,</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sox9"</span>,</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sparc"</span>,</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Spon1"</span>,</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tafa1"</span>,</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Timp3"</span>,</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tkt"</span>,</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Trpv1"</span>,</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vcam1"</span>,</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Vegfa"</span>,</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>nmr <span class="op">=</span> [</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1a"</span>,</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1b"</span>,</span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra1d"</span>,</span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2a"</span>,</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2b"</span>,</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adra2c"</span>,</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb1"</span>,</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb2"</span>,</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrb3"</span>,</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk1"</span>,</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrbk2"</span>,</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adrm1"</span>,  <span class="co"># adrenergic receptors</span></span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora1"</span>,</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2a"</span>,</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora2b"</span>,</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Adora3"</span>,  <span class="co"># adenosine receptors</span></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrm1"</span>,</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrm2"</span>,</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrm3"</span>,</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrm4"</span>,</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrm5"</span>,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna1"</span>,</span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna2"</span>,</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna3"</span>,</span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna4"</span>,</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna5"</span>,</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna6"</span>,</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna7"</span>,</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna9"</span>,</span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrna10"</span>,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb1"</span>,</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb2"</span>,</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnb3"</span>,</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrnd"</span>,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Chrng"</span>,  <span class="co"># cholinergic receptors</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria1"</span>,</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria2"</span>,</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria3"</span>,</span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gria4"</span>,  <span class="co"># iGlu AMPA receptors</span></span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid1"</span>,</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grid2"</span>,  <span class="co"># iGlu delta receptors</span></span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik1"</span>,</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik2"</span>,</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik3"</span>,</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik4"</span>,</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grik5"</span>,  <span class="co"># iGlu kainate receptors</span></span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin1"</span>,</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2a"</span>,</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2b"</span>,</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2c"</span>,</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin2d"</span>,</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3a"</span>,</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grin3b"</span>,  <span class="co"># iGlu NMDA receptors</span></span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm1"</span>,</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm5"</span>,  <span class="co"># mGluRs 1</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm2"</span>,</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm3"</span>,  <span class="co"># mGluRs 2</span></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm4"</span>,</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm6"</span>,</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm7"</span>,</span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Grm8"</span>,  <span class="co"># mGluRs 3</span></span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra1"</span>,</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra2"</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra3"</span>,</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra4"</span>,</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra5"</span>,</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabra6"</span>,</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb1"</span>,</span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb2"</span>,</span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrb3"</span>,</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg1"</span>,</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg2"</span>,</span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrg3"</span>,</span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrd"</span>,</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabre"</span>,</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrp"</span>,</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrq"</span>,</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr1"</span>,</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr2"</span>,</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabrr3"</span>,</span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr1"</span>,</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gabbr2"</span>,  <span class="co"># GABA receptors</span></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd1"</span>,</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd2"</span>,</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd3"</span>,</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd4"</span>,</span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drd5"</span>,  <span class="co"># dopamine receptors</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1a"</span>,</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1b"</span>,</span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1d"</span>,</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr1f"</span>,</span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2a"</span>,</span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2b"</span>,</span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr2c"</span>,</span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3a"</span>,</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr3b"</span>,</span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr4"</span>,</span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5a"</span>,</span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr5b"</span>,</span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr6"</span>,</span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Htr7"</span>,  <span class="co"># serotonin receptors</span></span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnas"</span>,</span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai1"</span>,</span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai2"</span>,</span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnai3"</span>,</span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao1"</span>,</span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnao2"</span>,</span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnaq"</span>,</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna11"</span>,</span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna12"</span>,</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gna13"</span>,</span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnal"</span>,</span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnasxl"</span>,  <span class="co"># G protein alpha subunit</span></span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb1"</span>,</span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb2"</span>,</span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb3"</span>,</span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb4"</span>,</span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gnb5"</span>,  <span class="co"># G protein beta subunit</span></span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng2"</span>,</span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng3"</span>,</span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng4"</span>,</span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng5"</span>,</span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng7"</span>,</span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng8"</span>,</span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng10"</span>,</span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng11"</span>,</span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng12"</span>,</span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gng13"</span>,</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt1"</span>,</span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gngt2"</span>,  <span class="co"># G protein gamma subunit</span></span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx1"</span>,</span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx2"</span>,</span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx3"</span>,</span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx4"</span>,</span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx5"</span>,</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx6"</span>,</span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2rx7"</span>,</span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry1"</span>,</span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry2"</span>,</span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry4"</span>,</span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry6"</span>,</span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry12"</span>,</span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry13"</span>,</span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2ry14"</span>,  <span class="co"># purinergic receptors</span></span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr1"</span>,</span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr2"</span>,</span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ryr3"</span>,  <span class="co"># ryanodine receptors</span></span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>mitochondrial <span class="op">=</span> [</span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn1"</span>,  <span class="co"># Mitofusin 1: A GTPase located on the outer mitochondrial membrane that plays a crucial role in mitochondrial fusion. Mfn1 mediates tethering and fusion of the outer mitochondrial membranes, helping to maintain the integrity and function of the mitochondrial network.</span></span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mfn2"</span>,  <span class="co"># Mitofusin 2: Another GTPase on the outer mitochondrial membrane that is involved in mitochondrial fusion. Mfn2 works in concert with Mfn1 to mediate the fusion of outer mitochondrial membranes, maintaining proper mitochondrial function and dynamics.</span></span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Opa1"</span>,  <span class="co"># Optic atrophy 1: A dynamin-related GTPase located in the inner mitochondrial membrane that is crucial for the regulation of mitochondrial fusion. Opa1 mediates the fusion of inner mitochondrial membranes, contributing to the maintenance of mitochondrial morphology, cristae structure, and overall mitochondrial function. Additionally, Opa1 plays a role in the regulation of apoptosis and is involved in the proper functioning of the electron transport chain.</span></span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dnm1"</span>,  <span class="co"># Dynamin 1: A GTPase involved in the regulation of membrane remodeling and trafficking, including vesicle formation and endocytosis. It has also been implicated in the regulation of mitochondrial morphology and function.</span></span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Drp1"</span>,  <span class="co"># Dynamin-related protein 1: Another GTPase, which plays a central role in mitochondrial fission. It is recruited to the outer mitochondrial membrane during fission and is crucial for the proper division and maintenance of mitochondrial networks.</span></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dnm1l"</span>,  <span class="co"># Dynamin 1-like, involved in mitochondrial fission</span></span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fis1"</span>,  <span class="co"># Fission 1, involved in mitochondrial fission</span></span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mff"</span>,  <span class="co"># Mitochondrial fission factor, involved in mitochondrial fission</span></span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mid49"</span>,  <span class="co"># Mitochondrial dynamics protein of 49 kDa, involved in mitochondrial fission</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mid51"</span>,  <span class="co"># Mitochondrial dynamics protein of 51 kDa, involved in mitochondrial fission</span></span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ppargc1a"</span>,  <span class="co"># Peroxisome proliferator-activated receptor gamma coactivator 1-alpha, involved in mitochondrial biogenesis</span></span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ppargc1b"</span>,  <span class="co"># Peroxisome proliferator-activated receptor gamma coactivator 1-beta, involved in mitochondrial biogenesis</span></span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nrf1"</span>,  <span class="co"># Nuclear respiratory factor 1, involved in mitochondrial biogenesis</span></span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nrf2"</span>,  <span class="co"># Nuclear respiratory factor 2, involved in mitochondrial biogenesis</span></span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tfam"</span>,  <span class="co"># Mitochondrial transcription factor A, involved in mitochondrial biogenesis</span></span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sod2"</span>,  <span class="co"># Superoxide dismutase 2, involved in mitochondrial antioxidant defense</span></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Prdx3"</span>,  <span class="co"># Peroxiredoxin 3, involved in mitochondrial antioxidant defense</span></span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc25a1"</span>,  <span class="co"># Solute carrier family 25 member 1, involved in mitochondrial metabolism</span></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc25a4"</span>,  <span class="co"># Solute carrier family 25 member 4, involved in mitochondrial metabolism</span></span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc25a5"</span>,  <span class="co"># Solute carrier family 25 member 5, involved in mitochondrial metabolism</span></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Uqcrc1"</span>,  <span class="co"># Ubiquinol-cytochrome c reductase core protein 1, involved in mitochondrial electron transport chain</span></span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Uqcrc2"</span>,  <span class="co"># Ubiquinol-cytochrome c reductase core protein 2, involved in mitochondrial electron transport chain</span></span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cox4i1"</span>,  <span class="co"># Cytochrome c oxidase subunit 4 isoform 1, involved in mitochondrial electron transport chain</span></span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cox4i2"</span>,  <span class="co"># Cytochrome c oxidase subunit 4 isoform 2, involved in mitochondrial electron transport chain</span></span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Atp5a1"</span>,  <span class="co"># ATP synthase, H+ transporting, mitochondrial F1 complex, alpha subunit 1, involved in mitochondrial ATP production</span></span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Atp5b"</span>,  <span class="co"># ATP synthase, H+ transporting, mitochondrial F1 complex, beta subunit, involved in mitochondrial ATP production</span></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bak1"</span>,  <span class="co"># BCL2 antagonist/killer 1, involved in mitochondrial-mediated apoptosis</span></span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bax"</span>,  <span class="co"># BCL2 associated X, involved in mitochondrial-mediated apoptosis</span></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bcl2"</span>,  <span class="co"># B-cell CLL/lymphoma 2, involved in mitochondrial-mediated apoptosis</span></span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bcl2l1"</span>,  <span class="co"># BCL2-like 1, involved in mitochondrial-mediated apoptosis</span></span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bnip3"</span>,  <span class="co"># BCL2/adenovirus E1B 19kDa interacting protein 3, involved in mitoptosis</span></span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bnip3l"</span>,  <span class="co"># BCL2/adenovirus E1B 19kDa interacting protein 3-like, involved in mitoptosis</span></span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Casp9"</span>,  <span class="co"># Caspase 9, involved in mitochondrial-mediated apoptosis</span></span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cybb"</span>,  <span class="co"># Cytochrome b-245, beta polypeptide, involved in oxidative stress</span></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpx1"</span>,  <span class="co"># Glutathione peroxidase 1, involved in oxidative stress</span></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gpx4"</span>,  <span class="co"># Glutathione peroxidase 4, involved in oxidative stress</span></span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mapk14"</span>,  <span class="co"># Mitogen-activated protein kinase 14, involved in ischemia and oxidative stress</span></span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nfe2l2"</span>,  <span class="co"># Nuclear factor, erythroid 2 like 2, involved in oxidative stress response</span></span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nox4"</span>,  <span class="co"># NADPH oxidase 4, involved in oxidative stress</span></span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Polg"</span>,  <span class="co"># DNA polymerase gamma, involved in mitochondrial DNA replication</span></span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Polg2"</span>,  <span class="co"># DNA polymerase gamma 2, involved in mitochondrial DNA replication</span></span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pink1"</span>,  <span class="co"># PTEN-induced putative kinase 1, involved in mitophagy</span></span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Park2"</span>,  <span class="co"># Parkin RBR E3 ubiquitin protein ligase, involved in mitophagy</span></span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aifm1"</span>,  <span class="co"># Apoptosis-inducing factor, mitochondrion-associated, 1, involved in DNA damage and apoptosis</span></span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ogg1"</span>,  <span class="co"># 8-oxoguanine DNA glycosylase 1, involved in DNA damage repair</span></span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mutyh"</span>,  <span class="co"># MutY DNA glycosylase, involved in DNA damage repair</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sod1"</span>,  <span class="co"># Superoxide dismutase 1, involved in oxidative stress</span></span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sod3"</span>,  <span class="co"># Superoxide dismutase 3, involved in oxidative stress</span></span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ucp1"</span>,  <span class="co"># Uncoupling protein 1, involved in thermogenesis</span></span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ucp2"</span>,  <span class="co"># Uncoupling protein 2, involved in thermogenesis</span></span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ucp3"</span>,  <span class="co"># Uncoupling protein 3, involved in thermogenesis</span></span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ucp4"</span>,  <span class="co"># Uncoupling protein 4, involved in thermogenesis</span></span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ucp5"</span>,  <span class="co"># Uncoupling protein 5, involved in thermogenesis</span></span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fgf21"</span>,  <span class="co"># Fibroblast growth factor 21, involved in metabolic regulation</span></span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Klb"</span>,  <span class="co"># Klotho beta (beta-klotho), co-receptor for Fgf21</span></span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional genes related to brain metabolism switch and different catabolic/anabolic modes</span></span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bdh1"</span>,  <span class="co"># 3-hydroxybutyrate dehydrogenase 1, involved in ketone body metabolism</span></span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bdh2"</span>,  <span class="co"># 3-hydroxybutyrate dehydrogenase 2, involved in ketone body metabolism</span></span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hmgcs2"</span>,  <span class="co"># 3-hydroxy-3-methylglutaryl-CoA synthase 2, involved in ketone body synthesis</span></span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc16a1"</span>,  <span class="co"># Solute carrier family 16 member 1 (monocarboxylate transporter 1), involved in ketone body transport</span></span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc16a7"</span>,  <span class="co"># Solute carrier family 16 member 7 (monocarboxylate transporter 2), involved in ketone body transport</span></span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc2a1"</span>,  <span class="co"># Solute carrier family 2 member 1 (glucose transporter type 1), involved in glucose transport</span></span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slc2a3"</span>,  <span class="co"># Solute carrier family 2 member 3 (glucose transporter type 3), involved in glucose transport</span></span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gck"</span>,  <span class="co"># Glucokinase, involved in glycolysis</span></span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pfkp"</span>,  <span class="co"># Phosphofructokinase, platelet, involved in glycolysis</span></span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pkm"</span>,  <span class="co"># Pyruvate kinase, muscle, involved in glycolysis</span></span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdha1"</span>,  <span class="co"># Pyruvate dehydrogenase E1 alpha 1, involved in the conversion of pyruvate to acetyl-CoA</span></span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdha2"</span>,  <span class="co"># Pyruvate dehydrogenase E1 alpha 2, involved in the conversion of pyruvate to acetyl-CoA</span></span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdk1"</span>,  <span class="co"># Pyruvate dehydrogenase kinase 1, involved in the regulation of pyruvate dehydrogenase complex</span></span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdk2"</span>,  <span class="co"># Pyruvate dehydrogenase kinase 2, involved in the regulation of pyruvate dehydrogenase complex</span></span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdk3"</span>,  <span class="co"># Pyruvate dehydrogenase kinase 3, involved in the regulation of pyruvate dehydrogenase complex</span></span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pdk4"</span>,  <span class="co"># Pyruvate dehydrogenase kinase 4, involved in the regulation of pyruvate dehydrogenase complex</span></span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acox1"</span>,  <span class="co"># Acyl-CoA oxidase 1, involved in fatty acid oxidation</span></span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cpt1a"</span>,  <span class="co"># Carnitine palmitoyltransferase 1A, involved in fatty acid oxidation</span></span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cpt1b"</span>,  <span class="co"># Carnitine palmitoyltransferase 1B, involved in fatty acid oxidation</span></span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cpt1c"</span>,  <span class="co"># Carnitine palmitoyltransferase 1C, involved in fatty acid oxidation</span></span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Cpt2"</span>,  <span class="co"># Carnitine palmitoyltransferase 2, involved in fatty acid oxidation</span></span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acsl1"</span>,  <span class="co"># Acyl-CoA synthetase long-chain family member 1, involved in fatty acid activation</span></span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acsl3"</span>,  <span class="co"># Acyl-CoA synthetase long-chain family member 3, involved in fatty acid activation</span></span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acsl4"</span>,  <span class="co"># Acyl-CoA synthetase long-chain family member 4, involved in fatty acid activation</span></span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acsl5"</span>,  <span class="co"># Acyl-CoA synthetase long-chain family member 5, involved in fatty acid activation</span></span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acsl6"</span>,  <span class="co"># Acyl-CoA synthetase long-chain family member 6, involved in fatty acid activation</span></span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acly"</span>,  <span class="co"># ATP citrate lyase, involved in fatty acid synthesis</span></span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fasn"</span>,  <span class="co"># Fatty acid synthase, involved in fatty acid synthesis</span></span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scd1"</span>,  <span class="co"># Stearoyl-CoA desaturase 1, involved in fatty acid desaturation</span></span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scd2"</span>,  <span class="co"># Stearoyl-CoA desaturase 2, involved in fatty acid desaturation</span></span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa1"</span>,  <span class="co"># Acetyl-CoA acyltransferase 1: Involved in the beta-oxidation of fatty acids in the mitochondria. Catalyzes the last step in the breakdown of fatty acids, converting 3-ketoacyl-CoA to acetyl-CoA.</span></span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Acaa2"</span>,  <span class="co"># Acetyl-CoA acyltransferase 2: Also involved in beta-oxidation of fatty acids in the mitochondria. Similar to Acaa1, it catalyzes the last step of fatty acid breakdown but has different substrate specificity.</span></span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aldh1a1"</span>,  <span class="co"># Aldehyde dehydrogenase 1 family, member A1: An enzyme involved in the detoxification of aldehydes (generated from alcohol metabolism and lipid peroxidation) by converting them to carboxylic acids.</span></span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Eno1"</span>,  <span class="co"># Enolase 1: A glycolytic enzyme that catalyzes the conversion of 2-phosphoglycerate to phosphoenolpyruvate in the glycolysis pathway, which generates ATP through the breakdown of glucose.</span></span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hadhb"</span>,  <span class="co"># Hydroxyacyl-CoA dehydrogenase/3-ketoacyl-CoA thiolase/enoyl-CoA hydratase, beta subunit: A mitochondrial enzyme that participates in fatty acid beta-oxidation, playing a role in multiple steps of the process.</span></span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pygb"</span>,  <span class="co"># Glycogen phosphorylase, brain form: An enzyme that breaks down glycogen into glucose-1-phosphate, which is then converted to glucose-6-phosphate for entry into glycolysis. This enzyme plays a critical role in energy production, particularly during periods of increased energy demand.</span></span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">parameters</h3>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bioproject <span class="op">=</span> <span class="st">"PRJNA847050"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance Metric to Use</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># metric = snakemake.params["metric"]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>metric <span class="op">=</span> <span class="st">"euclidean"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># connectivity_model = snakemake.params["connectivity_model"]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>connectivity_model <span class="op">=</span> <span class="st">"min_tree"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>PLOTS_DIR <span class="op">=</span> os.path.join(<span class="st">"../output/figures/velocity-signalling/"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>os.makedirs(PLOTS_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>OUT_DIR <span class="op">=</span> os.path.join(<span class="st">"../data/velocity-signalling/"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>os.makedirs(OUT_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting params</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>pt_size <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>dnsty <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt_size <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">5</span>]</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>SMALL_SIZE <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>MEDIUM_SIZE <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>BIGGER_SIZE <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"font"</span>, size<span class="op">=</span>SMALL_SIZE)  <span class="co"># controls default text sizes</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, titlesize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the axes title</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"axes"</span>, labelsize<span class="op">=</span>MEDIUM_SIZE)  <span class="co"># fontsize of the x and y labels</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"xtick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"ytick"</span>, labelsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># fontsize of the tick labels</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"legend"</span>, fontsize<span class="op">=</span>SMALL_SIZE)  <span class="co"># legend fontsize</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">"figure"</span>, titlesize<span class="op">=</span>BIGGER_SIZE)  <span class="co"># fontsize of the figure title</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.use14corefonts"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"pdf.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"ps.fonttype"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.family"</span>] <span class="op">=</span> <span class="st">"sans-serif"</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"font.sans-serif"</span>] <span class="op">=</span> [<span class="st">"Helvetica"</span>]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">"figure.max_open_warning"</span>] <span class="op">=</span> <span class="dv">20000</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>reseed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>random.seed(reseed)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>np.random.seed(reseed)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span> check_random_state(reseed)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>verbose <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>sc.settings.verbosity <span class="op">=</span> <span class="dv">2</span>  <span class="co"># verbosity: errors (0), warnings (1), info (2), hints (3)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>scv.settings.set_figure_params(<span class="st">"scvelo"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>sc.settings.figdir <span class="op">=</span> PLOTS_DIR</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>sc.settings.writedir <span class="op">=</span> OUT_DIR</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>sc.settings.set_figure_params(</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    dpi<span class="op">=</span><span class="dv">120</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    dpi_save<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    vector_friendly<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"pdf"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    transparent<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    color_map<span class="op">=</span><span class="st">"gnuplot_r"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>sc.settings.autoshow <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>sc.settings.autosave <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># k = int(snakemake.params["k"])</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> k <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>npcs <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>npcs_selected <span class="op">=</span> npcs <span class="op">-</span> <span class="dv">20</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>min_shared_umis <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>n_top_hvg <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>cb_fpr <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>paga_threshold <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>spread <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>threads <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>svm_fit_strength <span class="op">=</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>housekeeping <span class="op">=</span> <span class="ss">f"/data/data/housekeeping_mouse.tsv"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hk_genes1 <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(housekeeping) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> hk_genes :<span class="op">=</span> <span class="bu">file</span>.readline():</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        hk_genes1.append(hk_genes.rstrip())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>adata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA847050-astrocytes_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-initial_selection.h5ad"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>adata.obs[<span class="st">"cell_id"</span>] <span class="op">=</span> adata.obs_names</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> sc.read_h5ad(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../data/class_cello/PRJNA847050-whole_dataset-</span><span class="sc">{</span>cb_fpr<span class="sc">}</span><span class="ss">-cello_annotation.h5ad"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>alldata <span class="op">=</span> alldata[alldata.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Astrocytes"</span>, <span class="st">"Neurons"</span>])]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>adata_hfd <span class="op">=</span> alldata[alldata.obs[<span class="st">"condit"</span>] <span class="op">==</span> <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="signalling-analysis" class="level3">
<h3 class="anchored" data-anchor-id="signalling-analysis">Signalling analysis</h3>
<section id="normal-diet" class="level4">
<h4 class="anchored" data-anchor-id="normal-diet">Normal diet</h4>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>adata_norm.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;2240x24746 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 7297291 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pomc_neurons <span class="op">=</span> adata_norm[</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Pomc"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Neurons"</span>])),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>npy_neurons <span class="op">=</span> adata_norm[</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        (adata_norm[:, <span class="st">"Agrp"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> (adata_norm[:, <span class="st">"Npy"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Neurons"</span>])),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>lxn_pos_astro <span class="op">=</span> adata_norm[</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Lxn"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>lxn_neg_astro <span class="op">=</span> adata_norm[</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    (adata_norm[:, <span class="st">"Lxn"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_norm.obs_names.isin(adata.obs_names)),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"POMC neurons"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(pomc_neurons.obs.index), <span class="st">"goi"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"POMC neurons"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"AGRP/NPY neurons"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(npy_neurons.obs.index), <span class="st">"goi"</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"AGRP/NPY neurons"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN+"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN+"</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_norm.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN-"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>adata_norm.obs.loc[</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN-"</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>adata_norm <span class="op">=</span> adata_norm[</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    adata_norm.obs[<span class="st">"goi"</span>].isin(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>, <span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>]</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>adata_norm.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_norm, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_norm)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>adata_norm.var_names <span class="op">=</span> [x.upper() <span class="cf">for</span> x <span class="kw">in</span> adata_norm.var_names]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>adata_norm.raw <span class="op">=</span> adata_norm</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    adata_norm,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"cellchatdb"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].to_csv(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arc_astro-with_npy_pomc-liana-res-lxn-cellchatdb.csv"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>adata_norm.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4075</th>
      <td>Astro_LXN-</td>
      <td>Astro_LXN-</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.502105</td>
      <td>0.00000</td>
      <td>11.927501</td>
      <td>0.066820</td>
      <td>0.509698</td>
      <td>0.074707</td>
      <td>0.958519</td>
      <td>0.308378</td>
      <td>0.00000</td>
      <td>0.000055</td>
      <td>0.001076</td>
      <td>8.583044e-11</td>
    </tr>
    <tr>
      <th>1111</th>
      <td>Astro_LXN-</td>
      <td>POMC neurons</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.538962</td>
      <td>0.10309</td>
      <td>12.228462</td>
      <td>0.111379</td>
      <td>0.254041</td>
      <td>0.076592</td>
      <td>0.959011</td>
      <td>0.303828</td>
      <td>0.40556</td>
      <td>0.000465</td>
      <td>0.001877</td>
      <td>1.310029e-10</td>
    </tr>
    <tr>
      <th>3879</th>
      <td>Astro_LXN+</td>
      <td>Astro_LXN-</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.415033</td>
      <td>0.82932</td>
      <td>11.418758</td>
      <td>-0.054098</td>
      <td>0.107214</td>
      <td>0.071520</td>
      <td>0.957643</td>
      <td>0.298953</td>
      <td>0.83667</td>
      <td>0.003985</td>
      <td>0.011244</td>
      <td>6.865534e-10</td>
    </tr>
    <tr>
      <th>856</th>
      <td>Astro_LXN+</td>
      <td>POMC neurons</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.451889</td>
      <td>0.51401</td>
      <td>11.706881</td>
      <td>-0.009539</td>
      <td>-0.148443</td>
      <td>0.073325</td>
      <td>0.958146</td>
      <td>0.294482</td>
      <td>0.78073</td>
      <td>0.002865</td>
      <td>0.008540</td>
      <td>1.047865e-09</td>
    </tr>
    <tr>
      <th>3170</th>
      <td>Astro_LXN-</td>
      <td>Astro_LXN+</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.365475</td>
      <td>0.97043</td>
      <td>10.811831</td>
      <td>-0.098361</td>
      <td>0.157456</td>
      <td>0.067719</td>
      <td>0.956522</td>
      <td>0.290670</td>
      <td>0.97238</td>
      <td>0.006359</td>
      <td>0.016596</td>
      <td>2.046456e-09</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_probs"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family ['Dejavu Sans'] not found. Falling back to Helvetica.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>n2a_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>    n2a_norm</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>n2a_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_probs"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-normal-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-normal-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>a2n_norm <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_norm,</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    a2n_norm</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>a2n_norm.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-normal-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>adata_norm.write(</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-norm-cellchatdb.h5ad"</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="high-fat-high-sugar-diet" class="level4">
<h4 class="anchored" data-anchor-id="high-fat-high-sugar-diet">High Fat High Sugar Diet</h4>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"k_tree"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"k_tree"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>adata_hfd.raw.X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;4378x24746 sparse matrix of type '&lt;class 'numpy.float32'&gt;'
    with 13180870 stored elements in Compressed Sparse Column format&gt;</code></pre>
</div>
</div>
<p>subset groups of interest</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>pomc_neurons <span class="op">=</span> adata_hfd[</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>    (adata_hfd[:, <span class="st">"Pomc"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_hfd.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Neurons"</span>])),</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>npy_neurons <span class="op">=</span> adata_hfd[</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>        (adata_hfd[:, <span class="st">"Agrp"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> (adata_hfd[:, <span class="st">"Npy"</span>].to_df() <span class="op">&gt;</span> <span class="dv">10</span>).stack().values</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_hfd.obs[<span class="st">"ora_celltype"</span>].isin([<span class="st">"Neurons"</span>])),</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>lxn_pos_astro <span class="op">=</span> adata_hfd[</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>    (adata_hfd[:, <span class="st">"Lxn"</span>].to_df() <span class="op">&gt;</span> <span class="dv">1</span>).stack().values</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_hfd.obs_names.isin(adata.obs_names)),</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>lxn_neg_astro <span class="op">=</span> adata_hfd[</span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>    (adata_hfd[:, <span class="st">"Lxn"</span>].to_df() <span class="op">==</span> <span class="dv">0</span>).stack().values</span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (adata_hfd.obs_names.isin(adata.obs_names)),</span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a>    :,</span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"k_tree"</span>]</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"POMC neurons"</span>)</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs.loc[</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(pomc_neurons.obs.index), <span class="st">"goi"</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"POMC neurons"</span></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"AGRP/NPY neurons"</span>)</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs.loc[</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(npy_neurons.obs.index), <span class="st">"goi"</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"AGRP/NPY neurons"</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN+"</span>)</span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs.loc[</span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_pos_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN+"</span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>] <span class="op">=</span> adata_hfd.obs[<span class="st">"goi"</span>].cat.add_categories(<span class="st">"Astro_LXN-"</span>)</span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs.loc[</span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> df: df.index.isin(lxn_neg_astro.obs.index), <span class="st">"goi"</span></span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a>] <span class="op">=</span> <span class="st">"Astro_LXN-"</span></span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a>adata_hfd <span class="op">=</span> adata_hfd[</span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a>    adata_hfd.obs[<span class="st">"goi"</span>].isin(</span>
<span id="cb267-21"><a href="#cb267-21" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>, <span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>]</span>
<span id="cb267-22"><a href="#cb267-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb267-23"><a href="#cb267-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb267-24"><a href="#cb267-24" aria-hidden="true" tabindex="-1"></a>adata_hfd.obs[<span class="st">"goi"</span>].cat.remove_unused_categories(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>sc.pp.normalize_total(adata_hfd, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>sc.pp.log1p(adata_hfd)</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>adata_hfd.var_names <span class="op">=</span> [x.upper() <span class="cf">for</span> x <span class="kw">in</span> adata_hfd.var_names]</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>adata_hfd.raw <span class="op">=</span> adata_hfd</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>li.mt.rank_aggregate(</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>    adata_hfd,</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>    groupby<span class="op">=</span><span class="st">"goi"</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>    de_method<span class="op">=</span><span class="st">"logreg"</span>,</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>    expr_prop<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>    min_cells<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>    return_all_lrs<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>    resource_name<span class="op">=</span><span class="st">"cellchatdb"</span>,</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>    n_perms<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span>reseed,</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>normalizing counts per cell</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    finished (0:00:00)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>... as `zero_center=True`, sparse input is densified and may lead to large memory consumption</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>adata_hfd.uns[<span class="st">"liana_res"</span>].to_csv(</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hfd-arc_astro-with_npy_pomc-liana-res-lxn-cellchatdb.csv"</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>adata_hfd.uns[<span class="st">"liana_res"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>target</th>
      <th>ligand_complex</th>
      <th>receptor_complex</th>
      <th>lr_means</th>
      <th>cellphone_pvals</th>
      <th>expr_prod</th>
      <th>scaled_weight</th>
      <th>lr_logfc</th>
      <th>spec_weight</th>
      <th>lrscore</th>
      <th>lr_probs</th>
      <th>cellchat_pvals</th>
      <th>steady_rank</th>
      <th>specificity_rank</th>
      <th>magnitude_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3554</th>
      <td>Astro_LXN-</td>
      <td>Astro_LXN-</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.444833</td>
      <td>0.00000</td>
      <td>11.552505</td>
      <td>0.078248</td>
      <td>0.465159</td>
      <td>0.080212</td>
      <td>0.960145</td>
      <td>0.313295</td>
      <td>0.00000</td>
      <td>0.000197</td>
      <td>0.001120</td>
      <td>7.605305e-11</td>
    </tr>
    <tr>
      <th>952</th>
      <td>Astro_LXN-</td>
      <td>POMC neurons</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.455543</td>
      <td>0.09498</td>
      <td>11.638302</td>
      <td>0.090650</td>
      <td>0.208573</td>
      <td>0.080808</td>
      <td>0.960286</td>
      <td>0.301968</td>
      <td>0.69027</td>
      <td>0.000253</td>
      <td>0.001131</td>
      <td>3.569014e-10</td>
    </tr>
    <tr>
      <th>3364</th>
      <td>Astro_LXN+</td>
      <td>Astro_LXN-</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.377353</td>
      <td>0.53935</td>
      <td>11.163258</td>
      <td>-0.003452</td>
      <td>0.129421</td>
      <td>0.077510</td>
      <td>0.959484</td>
      <td>0.305508</td>
      <td>0.52727</td>
      <td>0.000899</td>
      <td>0.003249</td>
      <td>6.083476e-10</td>
    </tr>
    <tr>
      <th>2698</th>
      <td>Astro_LXN-</td>
      <td>Astro_LXN+</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.376360</td>
      <td>0.54931</td>
      <td>11.003963</td>
      <td>-0.001041</td>
      <td>0.191937</td>
      <td>0.076404</td>
      <td>0.959203</td>
      <td>0.299724</td>
      <td>0.96479</td>
      <td>0.000849</td>
      <td>0.003098</td>
      <td>1.188104e-09</td>
    </tr>
    <tr>
      <th>724</th>
      <td>Astro_LXN+</td>
      <td>POMC neurons</td>
      <td>NRXN1</td>
      <td>NLGN1</td>
      <td>3.388063</td>
      <td>0.45761</td>
      <td>11.246163</td>
      <td>0.008951</td>
      <td>-0.127165</td>
      <td>0.078085</td>
      <td>0.959627</td>
      <td>0.294342</td>
      <td>0.92436</td>
      <td>0.001063</td>
      <td>0.003739</td>
      <td>1.652089e-09</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>n2a_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_probs"</span>,</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a>    n2a_hfd</span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a>n2a_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-HFHS-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>n2a_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a>    n2a_hfd</span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb314-25"><a href="#cb314-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb314-26"><a href="#cb314-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb314-27"><a href="#cb314-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb314-28"><a href="#cb314-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-29"><a href="#cb314-29" aria-hidden="true" tabindex="-1"></a>n2a_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-HFHS-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>n2a_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a>    n2a_hfd</span>
<span id="cb354-19"><a href="#cb354-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb354-20"><a href="#cb354-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb354-21"><a href="#cb354-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb354-22"><a href="#cb354-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb354-23"><a href="#cb354-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb354-24"><a href="#cb354-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb354-25"><a href="#cb354-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb354-26"><a href="#cb354-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb354-27"><a href="#cb354-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb354-28"><a href="#cb354-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-29"><a href="#cb354-29" aria-hidden="true" tabindex="-1"></a>n2a_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-HFHS-diet-n2a-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>a2n_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"lr_probs"</span>,</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a>    a2n_hfd</span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb394-22"><a href="#cb394-22" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb394-23"><a href="#cb394-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb394-24"><a href="#cb394-24" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb394-25"><a href="#cb394-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb394-26"><a href="#cb394-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb394-27"><a href="#cb394-27" aria-hidden="true" tabindex="-1"></a>a2n_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-logfc-HFHS-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>a2n_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb432-13"><a href="#cb432-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb432-14"><a href="#cb432-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb432-15"><a href="#cb432-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb432-16"><a href="#cb432-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-17"><a href="#cb432-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb432-18"><a href="#cb432-18" aria-hidden="true" tabindex="-1"></a>    a2n_hfd</span>
<span id="cb432-19"><a href="#cb432-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb432-20"><a href="#cb432-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb432-21"><a href="#cb432-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb432-22"><a href="#cb432-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb432-23"><a href="#cb432-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb432-24"><a href="#cb432-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb432-25"><a href="#cb432-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb432-26"><a href="#cb432-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb432-27"><a href="#cb432-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb432-28"><a href="#cb432-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb432-29"><a href="#cb432-29" aria-hidden="true" tabindex="-1"></a>a2n_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-specificity_rank-HFHS-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>a2n_hfd <span class="op">=</span> li.pl.dotplot(</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>    adata<span class="op">=</span>adata_hfd,</span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a>    colour<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true" tabindex="-1"></a>    inverse_size<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb473-6"><a href="#cb473-6" aria-hidden="true" tabindex="-1"></a>    inverse_colour<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb473-7"><a href="#cb473-7" aria-hidden="true" tabindex="-1"></a>    source_labels<span class="op">=</span>[<span class="st">"Astro_LXN+"</span>, <span class="st">"Astro_LXN-"</span>],</span>
<span id="cb473-8"><a href="#cb473-8" aria-hidden="true" tabindex="-1"></a>    target_labels<span class="op">=</span>[<span class="st">"POMC neurons"</span>, <span class="st">"AGRP/NPY neurons"</span>],</span>
<span id="cb473-9"><a href="#cb473-9" aria-hidden="true" tabindex="-1"></a>    filterby<span class="op">=</span><span class="st">"specificity_rank"</span>,</span>
<span id="cb473-10"><a href="#cb473-10" aria-hidden="true" tabindex="-1"></a>    filter_lambda<span class="op">=</span><span class="kw">lambda</span> x: x <span class="op">&lt;=</span> <span class="fl">0.01</span>,</span>
<span id="cb473-11"><a href="#cb473-11" aria-hidden="true" tabindex="-1"></a>    top_n<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb473-12"><a href="#cb473-12" aria-hidden="true" tabindex="-1"></a>    orderby<span class="op">=</span><span class="st">"magnitude_rank"</span>,</span>
<span id="cb473-13"><a href="#cb473-13" aria-hidden="true" tabindex="-1"></a>    orderby_ascending<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb473-14"><a href="#cb473-14" aria-hidden="true" tabindex="-1"></a>    figure_size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb473-15"><a href="#cb473-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb473-16"><a href="#cb473-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-17"><a href="#cb473-17" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb473-18"><a href="#cb473-18" aria-hidden="true" tabindex="-1"></a>    a2n_hfd</span>
<span id="cb473-19"><a href="#cb473-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb473-20"><a href="#cb473-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change theme</span></span>
<span id="cb473-21"><a href="#cb473-21" aria-hidden="true" tabindex="-1"></a>    p9.theme_tufte()</span>
<span id="cb473-22"><a href="#cb473-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span></span>
<span id="cb473-23"><a href="#cb473-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify theme</span></span>
<span id="cb473-24"><a href="#cb473-24" aria-hidden="true" tabindex="-1"></a>    p9.theme(</span>
<span id="cb473-25"><a href="#cb473-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adjust facet size</span></span>
<span id="cb473-26"><a href="#cb473-26" aria-hidden="true" tabindex="-1"></a>        strip_text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb473-27"><a href="#cb473-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb473-28"><a href="#cb473-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb473-29"><a href="#cb473-29" aria-hidden="true" tabindex="-1"></a>a2n_hfd.save(filename<span class="op">=</span><span class="st">"liana-dotplot-magnitude_rank-HFHS-diet-a2n-cellchatdb.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>findfont: Font family 'Dejavu Sans' not found.</code></pre>
</div>
</div>
<p>Save data</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>adata_hfd.write(</span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"/data/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">/data/velocity-signalling/</span><span class="sc">{</span>bioproject<span class="sc">}</span><span class="ss">-signalling-treatment-cellchatdb.h5ad"</span></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark())</span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(watermark(iversions<span class="op">=</span><span class="va">True</span>, globals_<span class="op">=</span><span class="bu">globals</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Last updated: 2023-07-31T11:35:40.855234+00:00

Python implementation: CPython
Python version       : 3.8.8
IPython version      : 8.12.1

Compiler    : GCC 9.3.0
OS          : Linux
Release     : 5.15.0-76-generic
Machine     : x86_64
Processor   : x86_64
CPU cores   : 256
Architecture: 64bit

anndata   : 0.9.1
numpy     : 1.23.5
matplotlib: 3.7.1
umap      : 0.5.3
scvelo    : 0.2.5
pandas    : 1.5.3
plotnine  : 0.10.1
liana     : 0.1.8
scipy     : 1.10.1
cellrank  : 1.5.1
scanpy    : 1.9.3
pacmap    : 0.7.0
sklearn   : 1.2.2
</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>